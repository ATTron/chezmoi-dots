# set dir for zinit
ZINIT_HOME="${XDG_DATA_HOME:-${HOME}/.local/share}/zinit/zinit.git"

# download if zinit isnt found
if [ ! -d "$ZINIT_HOME" ]; then
  mkdir -p "$(dirname $ZINIT_HOME)"
  git clone https://github.com/zdharma-continuum/zinit.git "$ZINIT_HOME"
fi

export SHELL="/usr/bin/zsh"

# keybinds
# bindkey -v # vim keybinds
bindkey -e

# load zinit
source "${ZINIT_HOME}/zinit.zsh"

# env setup
#. "$HOME/.local/bin/env"
# linuxbrew to PATH
export PATH="/home/linuxbrew/.linuxbrew/bin:${PATH}"

# fzf
export PATH="${HOME}/.fzf/bin:${PATH}"

# fix ghostty
export TERM="xterm-256color"

# cargo setup
export PATH="${HOME}/.cargo/bin:${PATH}"

# go setup
export GOPATH="${HOME}/go"
export PATH="${GOPATH}/bin:${PATH}"

# zig setup
export PATH="${HOME}/.local/bin:$PATH"
export PATH="${HOME}/.local/zig:$PATH"

# c3 setup
export PATH="${HOME}/.local/bin/c3:$PATH"

# nvm setup
export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] && printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"

# speed up zsh
SPACESHIP_PROMPT_ASYNC=true
SPACESHIP_PROMPT_ADD_NEWLINE=true

SPACESHIP_PROMPT_ORDER=(
  time
  user
  dir
  git
  line_sep
  char
)

ZSH_AUTOSUGGEST_BUFFER_MAX_SIZE="20"
ZSH_AUTOSUGGEST_USE_ASYNC=1
## plugins
zinit light zsh-users/zsh-completions
# autoload -U compinit && compinit
# load completions smartly (fast)
autoload -Uz compinit
for dump in ~/.zcompdump(N.mh+24); do
  compinit
done
compinit -C

zinit cdreplay -q

zinit load zdharma-continuum/history-search-multi-word
zinit light zsh-users/zsh-autosuggestions
zinit light zdharma-continuum/fast-syntax-highlighting
zinit light Aloxaf/fzf-tab

# snippets
zinit snippet OMZP::archlinux
zinit snippet OMZP::aws
zinit snippet OMZP::command-not-found
zinit snippet OMZP::sudo

# completion styling
zstyle ':omz:plugins:nvm' lazy yes
zstyle ":completion:*" matcher-list "m:{a-z}={A-Za-z}"
zstyle ":completion:*" list-colors "${(s.:.)LS_COLORS}"
zstyle ":completion:*" menu no
zstyle ":fzf-tab:complete:cd:*" fzf-preview 'ls --color $realpath'
zstyle ":fzf-tab:complete:__zoxide_z:*" fzf-preview 'ls --color $realpath'

# history
HISTSIZE=5000
HISTFILE=~/.zsh_history
SAVEHIST=$HISTSIZE
HISTDUP=erase
setopt appendhistory
setopt sharehistory
setopt hist_ignore_space
setopt hist_ignore_all_dups
setopt hist_save_no_dups
setopt hist_ignore_dups
setopt hist_find_no_dups

## shell integrations
# fzf
eval "$(fzf --zsh)"
# starship
eval "$(starship init zsh)"
# zoxide
eval "$(zoxide init --cmd cd zsh)"

# alias section
alias nvim="~/.local/share/bob/nvim-bin/nvim"
alias ls='ls --color'
alias setup-pod='devpod up . --dotfiles git@github.com:ATTron/chezmoi-dots.git --configure-ssh --git-ssh-signing-key ~/.ssh/id_ed25519 --ide None --recreate'
alias ll='ls -l'
alias la='ls -la'
alias tmux='tmux -u'
alias k='kubectl'
#alias ls='eza $eza_params'
#alias l='eza --git-ignore $eza_params'
#alias ll='eza --all --header --long $eza_params'
#alias llm='eza --all --header --long --sort=modified $eza_params'
#alias la='eza -lbhHigUmuSa'
#alias lx='eza -lbhHigUmuSa@'
#alias lt='eza --tree $eza_params'
#alias tree='eza --tree $eza_params'
